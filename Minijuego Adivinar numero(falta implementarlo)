| empateTotal intentosAdivina numRonda ganador empate acerto1 acerto2 distancia1 distancia2 intentos1 intentos2  numAdivinar1 numAdivinar2 jugador1 jugador2 respuesta1 respuesta2 |

jugador1:= 1.
numAdivinar1:= (1 to: 200) atRandom.
intentos1:= 0.
distancia1:= 0.
acerto1:= false.

jugador2:= 2.
numAdivinar2:= (1 to: 200) atRandom.
intentos2:= 0.
distancia2:= 0.
acerto2:= false.

numRonda:= 0.
ganador:= 0.
empate:= true. "guarda si hay empate en la ronda"
empateTotal:= false. "guarda si hay empate en el juego completo"

Transcript clear.
Transcript show: '---ADIVINAR NUMERO---' ; cr.
Transcript show: 'El numero a divinar es entre 1 y 200' ; cr.
Transcript show: 'Con 3 intentos (2 pistas)' ; cr.
Transcript show: 'Gana el que este a menor distancia' ; cr.
Transcript cr. "para que se vea mejor"

[empate] whileTrue: [ 
	
	[((acerto1 not) and: (acerto2 not)) and: ((intentos1 < 3) and: (intentos2 < 3))] whileTrue: [	 
		
		numRonda:= numRonda + 1.
		Transcript show: '-Ronda ' , (numRonda asString) , '-' ; cr.
		
		"SELECCIONA NUMERO"
	
		"JUGADOR 1"
		respuesta1:= (UIManager default request: 'Turno jugador', (jugador1 asString) , ' - Ingresa numero a adivinar'). 
		"controla si presiona cancel"
		[(respuesta1 isNil)] whileTrue: [ 
			respuesta1:= (UIManager default request: 'Turno jugador', (jugador1 asString) , ' - Error, no selecciono nada vuelva a intentarlo').
			].
		"controla que sea entero"
		[(respuesta1 asInteger) isInteger] whileFalse: [ 
			respuesta1:= (UIManager default request: 'Turno jugador', (jugador1 asString) , ' - Error, vuelva a intentarlo').
			
			"controla si presiona cancel"
			[(respuesta1 isNil)] whileTrue: [ 
				respuesta1:= (UIManager default request: 'Turno jugador', (jugador1 asString) , ' - Error, no selecciono nada vuelva a intentarlo').
				].
			].
	
		"JUGADOR 2"
		respuesta2:= (UIManager default request: 'Turno jugador', (jugador2 asString) , ' - Ingresa numero a adivinar'). 
		"controla si presiona cancel"
		[(respuesta2 isNil)] whileTrue: [ 
			respuesta2:= (UIManager default request: 'Turno jugador', (jugador2 asString) , ' - Error, no selecciono nada vuelva a intentarlo').
			].
		"controla que sea entero"
		[(respuesta2 asInteger) isInteger] whileFalse: [ 
			respuesta2:= (UIManager default request: 'Turno jugador', (jugador2 asString) , ' - Error, vuelva a intentarlo').
			
			"controla si presiona cancel"
			[(respuesta2 isNil)] whileTrue: [ 
				respuesta2:= (UIManager default request: 'Turno jugador', (jugador2 asString) , ' - Error, no selecciono nada vuelva a intentarlo').
				].
			].
	
	
		"ANALIZA SI ADIVINO EL NUMERO"
		
		respuesta1:= respuesta1 asInteger.
		respuesta2:= respuesta2 asInteger.
		
		"JUGADOR 1"
		(respuesta1 = numAdivinar1) ifTrue: [ 
			acerto1:= true. "para que pueda terminar"
			Transcript show: 'El jugador' , (jugador1 asString) , ' adivino el numero' ; cr.
			]
		ifFalse: [ 
			"TIRAR PISTAS"
			(respuesta1 < numAdivinar1) ifTrue: [ 
				Transcript show: 'Turno jugador' , (jugador1 asString) , ' - El numero que ingresaste es ', (respuesta1 asString); cr.
				Transcript show: 'Turno jugador' , (jugador1 asString) , ' - El numero a adivinar es mayor' ; cr.
				]
			ifFalse: [ 
				Transcript show: 'Turno jugador' , (jugador1 asString) , ' - El numero que ingresaste es ', (respuesta1 asString); cr.
				Transcript show: 'Turno jugador' , (jugador1 asString) , ' - El numero a adivinar es menor' ; cr.
				].
			].
	
		"JUGADOR 2"
		(respuesta2 = numAdivinar2) ifTrue: [ 
			acerto2:= true. "para que pueda terminar"
			Transcript show: 'El jugador' , (jugador2 asString) , ' - adivino el numero' ; cr.
			]
		ifFalse: [ 
			"TIRAR PISTAS"
			(respuesta2 < numAdivinar2) ifTrue: [ 
				Transcript show: 'Turno jugador' , (jugador2 asString) , ' - El numero que ingresaste es ', (respuesta2 asString); cr.
				Transcript show: 'Turno jugador' , (jugador2 asString) , ' - El numero a adivinar es mayor' ; cr.
				]
			ifFalse: [ 
				Transcript show: 'Turno jugador' , (jugador2 asString) , ' - El numero que ingresaste es ', (respuesta2 asString); cr.
				Transcript show: 'Turno jugador' , (jugador2 asString) , ' - El numero a adivinar es menor' ; cr.
				].
			].
		
		intentos1:= intentos1 + 1.
		intentos2:= intentos2 + 1.
		
		].
	
	
	"TERMINA EL DUELO, HAGO CALCULO"
		"ANALIZO DISTANCIA QUE QUEDARON DEL NUMERO ADIVINAR"
	distancia1:= (numAdivinar1 - respuesta1) abs. "abs convierte el numero a positivo"
	distancia2:= (numAdivinar2 - respuesta2) abs. "abs convierte el numero a positivo"
	
	(intentos1 = intentos2) ifTrue: [ 
		
		(distancia1 = distancia2) ifTrue: [ 
			
			"empate de la ronda queda en verdadero"
			empateTotal:= true. "empate de todo le juego se pone en verdadero"
			Transcript cr. 
			Transcript show: '-EMPATE-' ; cr.
			Transcript show: 'APLAUSOS!! es muy dificil que pase, pense que hicimos esto y no se iba a usar' ; cr.
			Transcript show: 'Ambos jugadores quedaron a la misma distancia y mismos intentos' ; cr.
			Transcript show: 'Se vuelve a realizar el juego pero un solo intento un numero del 1 al 20' ; cr.
			numAdivinar1:= (1 to: 20) atRandom.
			numAdivinar2:= (1 to: 20) atRandom.
			intentos1:= 1.
			intentos2:= 1.
			]
		ifFalse: [ 
			(distancia1 < distancia2) ifTrue: [ 
				empate:= false.
				ganador:= 1.
				]
			ifFalse: [ 
				"distancia 1 > distancia2"
				empate:= false.
				ganador:= 2.
				].
			].
		
		]
	ifFalse: [ 
		
		(intentos1 < intentos2) ifTrue: [ 
			empate:= false.
			ganador:= 1.
			]
		ifFalse: [  
			"intentos1 > intentos2"
			empate:= false.
			ganador:= 2.
			].		
		
		].
	
	].

"YA HAY UN GANADOR ENTONCES INFORMO"
Transcript cr. "para que se vea mejor"
Transcript show: '-Duelo finalizado-' ; cr.

(ganador = 1) ifTrue: [ 
	
	(empateTotal) ifTrue: [ 
		Transcript show: 'Jugador' , (jugador1 asString) ,  ' - Es el ganador con desempate en la ronda ', (numRonda asString) , 'y el numero a adivinar era ', (numAdivinar1 asString) ; cr.
		Transcript show: 'Jugador' , (jugador1 asString) , ' - Con una distancia de ', (distancia1 asString) ; cr.
		Transcript show: 'Jugador' , (jugador2 asString) , ' - Perdio y quedo a una distancia de ', (distancia2 asString) ; cr.
		Transcript show: 'Jugador' , (jugador2 asString) ,' - El numero adivinar era ', (numAdivinar2 asString) ; cr.
		]
	ifFalse: [ 
		"no hubo empate"
		Transcript show: 'Jugador' , (jugador1 asString) ,  ' - Es el ganador y el numero adivinar era ', (numAdivinar1 asString) ; cr.
		Transcript show: 'Jugador' , (jugador1 asString) ,  ' - Con ', (intentos1) asString , ' intento/s y con una distancia de ', (distancia1 asString) ; cr.
		Transcript show: 'Jugador' , (jugador2 asString) ,  ' - Perdio y quedo a una distancia de ', (distancia2 asString) ; cr.
		Transcript show: 'Jugador' , (jugador2 asString) ,' - El numero adivinar era ', (numAdivinar2 asString) ; cr.
		].
	
	]

ifFalse: [  
	
	(empateTotal) ifTrue: [ 
		Transcript show: 'Jugador' , (jugador2 asString) ,  ' - Es el ganador con desempate en la ronda ', (numRonda asString) , ' y el numero a adivinar era ', (numAdivinar2 asString) ; cr.
		Transcript show: 'Jugador' , (jugador2 asString) , ' - Con una distancia de ', (distancia2 asString) ; cr.
		Transcript show: 'Jugador' , (jugador1 asString) , ' - Quedo a una distancia de ', (distancia1 asString) ; cr.
		Transcript show: 'Jugador' , (jugador1 asString) ,' - El numero adivinar era ', (numAdivinar1 asString) ; cr.
		]
	ifFalse: [ 
		"no hubo empate"
		Transcript show: 'Jugador' , (jugador2 asString) ,  ' - Es el ganador y el numero adivinar era ', (numAdivinar2 asString) ; cr.
		Transcript show: 'Jugador' , (jugador2 asString) ,  ' - Con ', (intentos2) asString , ' intento/s y con una distancia de ', (distancia2 asString) ; cr.
		Transcript show: 'Jugador' , (jugador1 asString) ,  ' - Perdio y quedo a una distancia de ', (distancia1 asString) ; cr.
		Transcript show: 'Jugador' , (jugador1 asString) ,' - El numero adivinar era ', (numAdivinar1 asString) ; cr.
		].
	
	].
